var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _native=_interopRequireDefault(require("@emotion/native"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _addons=_interopRequireDefault(require("@storybook/addons"));var _StoryListView=_interopRequireDefault(require("../StoryListView"));var _StoryView=_interopRequireDefault(require("../StoryView"));var _addons2=_interopRequireDefault(require("./addons"));var _panel=_interopRequireDefault(require("./panel"));var _navigation=_interopRequireDefault(require("./navigation"));var _absolutePositionedKeyboardAwareView=_interopRequireDefault(require("./absolute-positioned-keyboard-aware-view"));var _constants=require("./navigation/constants");var _animation=require("./animation");var _jsxFileName="/Users/shilman/projects/baseline/storybook/app/react-native/src/preview/components/OnDeviceUI/index.tsx";var ANIMATION_DURATION=300;var IS_IOS=_reactNative.Platform.OS==='ios';var flex={flex:1};var Preview=_native["default"].View(flex,function(_ref){var disabled=_ref.disabled,theme=_ref.theme;return{borderLeftWidth:disabled?0:1,borderTopWidth:disabled?0:1,borderRightWidth:disabled?0:1,borderBottomWidth:disabled?0:1,borderColor:disabled?'transparent':theme.previewBorderColor};},process.env.NODE_ENV==="production"?"":"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9wcmV2aWV3L2NvbXBvbmVudHMvT25EZXZpY2VVSS9pbmRleC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBbURnQiIsImZpbGUiOiIuLi8uLi8uLi8uLi9zcmMvcHJldmlldy9jb21wb25lbnRzL09uRGV2aWNlVUkvaW5kZXgudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IFB1cmVDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1xuICBLZXlib2FyZCxcbiAgS2V5Ym9hcmRBdm9pZGluZ1ZpZXcsXG4gIFBsYXRmb3JtLFxuICBBbmltYXRlZCxcbiAgRmxleFN0eWxlLFxuICBTYWZlQXJlYVZpZXcsXG4gIERpbWVuc2lvbnMsXG4gIFRvdWNoYWJsZU9wYWNpdHksXG59IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL25hdGl2ZSc7XG5pbXBvcnQgYWRkb25zIGZyb20gJ0BzdG9yeWJvb2svYWRkb25zJztcbmltcG9ydCBDaGFubmVsIGZyb20gJ0BzdG9yeWJvb2svY2hhbm5lbHMnO1xuaW1wb3J0IFN0b3J5TGlzdFZpZXcgZnJvbSAnLi4vU3RvcnlMaXN0Vmlldyc7XG5pbXBvcnQgU3RvcnlWaWV3IGZyb20gJy4uL1N0b3J5Vmlldyc7XG5pbXBvcnQgQWRkb25zIGZyb20gJy4vYWRkb25zJztcbmltcG9ydCBQYW5lbCBmcm9tICcuL3BhbmVsJztcbmltcG9ydCBOYXZpZ2F0aW9uIGZyb20gJy4vbmF2aWdhdGlvbic7XG5pbXBvcnQgQWJzb2x1dGVQb3NpdGlvbmVkS2V5Ym9hcmRBd2FyZVZpZXcsIHtcbiAgUHJldmlld0RpbWVucyxcbn0gZnJvbSAnLi9hYnNvbHV0ZS1wb3NpdGlvbmVkLWtleWJvYXJkLWF3YXJlLXZpZXcnO1xuaW1wb3J0IHsgUFJFVklFVyB9IGZyb20gJy4vbmF2aWdhdGlvbi9jb25zdGFudHMnO1xuaW1wb3J0IHtcbiAgZ2V0UHJldmlld1Bvc2l0aW9uLFxuICBnZXRQcmV2aWV3U2NhbGUsXG4gIGdldEFkZG9uUGFuZWxQb3NpdGlvbixcbiAgZ2V0TmF2aWdhdG9yUGFuZWxQb3NpdGlvbixcbn0gZnJvbSAnLi9hbmltYXRpb24nO1xuXG5jb25zdCBBTklNQVRJT05fRFVSQVRJT04gPSAzMDA7XG5jb25zdCBJU19JT1MgPSBQbGF0Zm9ybS5PUyA9PT0gJ2lvcyc7XG5cbmludGVyZmFjZSBPbkRldmljZVVJUHJvcHMge1xuICBzdG9yaWVzOiBhbnk7XG4gIHVybD86IHN0cmluZztcbiAgdGFiT3Blbj86IG51bWJlcjtcbiAgaXNVSUhpZGRlbj86IGJvb2xlYW47XG4gIHNob3VsZERpc2FibGVLZXlib2FyZEF2b2lkaW5nVmlldz86IGJvb2xlYW47XG4gIGtleWJvYXJkQXZvaWRpbmdWaWV3VmVydGljYWxPZmZzZXQ/OiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBPbkRldmljZVVJU3RhdGUge1xuICB0YWJPcGVuOiBudW1iZXI7XG4gIHNsaWRlQmV0d2VlbkFuaW1hdGlvbjogYm9vbGVhbjtcbiAgcHJldmlld1dpZHRoOiBudW1iZXI7XG4gIHByZXZpZXdIZWlnaHQ6IG51bWJlcjtcbn1cblxuY29uc3QgZmxleCA9IHsgZmxleDogMSB9O1xuXG5jb25zdCBQcmV2aWV3ID0gc3R5bGVkLlZpZXc8eyBkaXNhYmxlZDogYm9vbGVhbiB9PihmbGV4LCAoeyBkaXNhYmxlZCwgdGhlbWUgfSkgPT4gKHtcbiAgYm9yZGVyTGVmdFdpZHRoOiBkaXNhYmxlZCA/IDAgOiAxLFxuICBib3JkZXJUb3BXaWR0aDogZGlzYWJsZWQgPyAwIDogMSxcbiAgYm9yZGVyUmlnaHRXaWR0aDogZGlzYWJsZWQgPyAwIDogMSxcbiAgYm9yZGVyQm90dG9tV2lkdGg6IGRpc2FibGVkID8gMCA6IDEsXG4gIGJvcmRlckNvbG9yOiBkaXNhYmxlZCA/ICd0cmFuc3BhcmVudCcgOiB0aGVtZS5wcmV2aWV3Qm9yZGVyQ29sb3IsXG59KSk7XG5cbmNvbnN0IGFic29sdXRlUG9zaXRpb246IEZsZXhTdHlsZSA9IHsgcG9zaXRpb246ICdhYnNvbHV0ZScsIHRvcDogMCwgYm90dG9tOiAwLCBsZWZ0OiAwLCByaWdodDogMCB9O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPbkRldmljZVVJIGV4dGVuZHMgUHVyZUNvbXBvbmVudDxPbkRldmljZVVJUHJvcHMsIE9uRGV2aWNlVUlTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogT25EZXZpY2VVSVByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIGNvbnN0IHRhYk9wZW4gPSBwcm9wcy50YWJPcGVuIHx8IFBSRVZJRVc7XG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdGFiT3BlbixcbiAgICAgIHNsaWRlQmV0d2VlbkFuaW1hdGlvbjogZmFsc2UsXG4gICAgICBwcmV2aWV3V2lkdGg6IERpbWVuc2lvbnMuZ2V0KCd3aW5kb3cnKS53aWR0aCxcbiAgICAgIHByZXZpZXdIZWlnaHQ6IERpbWVuc2lvbnMuZ2V0KCd3aW5kb3cnKS5oZWlnaHQsXG4gICAgfTtcbiAgICB0aGlzLmFuaW1hdGVkVmFsdWUgPSBuZXcgQW5pbWF0ZWQuVmFsdWUodGFiT3Blbik7XG4gICAgdGhpcy5jaGFubmVsID0gYWRkb25zLmdldENoYW5uZWwoKTtcbiAgfVxuXG4gIG9uTGF5b3V0ID0gKHsgcHJldmlld1dpZHRoLCBwcmV2aWV3SGVpZ2h0IH06IFByZXZpZXdEaW1lbnMpID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHsgcHJldmlld1dpZHRoLCBwcmV2aWV3SGVpZ2h0IH0pO1xuICB9O1xuXG4gIGhhbmRsZU9wZW5QcmV2aWV3ID0gKCkgPT4ge1xuICAgIHRoaXMuaGFuZGxlVG9nZ2xlVGFiKFBSRVZJRVcpO1xuICB9O1xuXG4gIGhhbmRsZVRvZ2dsZVRhYiA9IChuZXdUYWJPcGVuOiBudW1iZXIpID0+IHtcbiAgICBjb25zdCB7IHRhYk9wZW4gfSA9IHRoaXMuc3RhdGU7XG4gICAgaWYgKG5ld1RhYk9wZW4gPT09IHRhYk9wZW4pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgQW5pbWF0ZWQudGltaW5nKHRoaXMuYW5pbWF0ZWRWYWx1ZSwge1xuICAgICAgdG9WYWx1ZTogbmV3VGFiT3BlbixcbiAgICAgIGR1cmF0aW9uOiBBTklNQVRJT05fRFVSQVRJT04sXG4gICAgICB1c2VOYXRpdmVEcml2ZXI6IHRydWUsXG4gICAgfSkuc3RhcnQoKTtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIHRhYk9wZW46IG5ld1RhYk9wZW4sXG4gICAgICAvLyBUcnVlIGlmIHN3aXBpbmcgYmV0d2VlbiBuYXZpZ2F0b3IgYW5kIGFkZG9uc1xuICAgICAgc2xpZGVCZXR3ZWVuQW5pbWF0aW9uOiB0YWJPcGVuICsgbmV3VGFiT3BlbiA9PT0gUFJFVklFVyxcbiAgICB9KTtcbiAgICAvLyBjbG9zZSB0aGUga2V5Ym9hcmQgb3BlbmVkIGZyb20gYSBUZXh0SW5wdXQgZnJvbSBzdG9yeSBsaXN0IG9yIGtub2JzXG4gICAgaWYgKG5ld1RhYk9wZW4gPT09IFBSRVZJRVcpIHtcbiAgICAgIEtleWJvYXJkLmRpc21pc3MoKTtcbiAgICB9XG4gIH07XG5cbiAgYW5pbWF0ZWRWYWx1ZTogQW5pbWF0ZWQuVmFsdWU7XG5cbiAgY2hhbm5lbDogQ2hhbm5lbDtcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge1xuICAgICAgc3RvcmllcyxcbiAgICAgIHVybCxcbiAgICAgIGlzVUlIaWRkZW4sXG4gICAgICBzaG91bGREaXNhYmxlS2V5Ym9hcmRBdm9pZGluZ1ZpZXcsXG4gICAgICBrZXlib2FyZEF2b2lkaW5nVmlld1ZlcnRpY2FsT2Zmc2V0LFxuICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgY29uc3QgeyB0YWJPcGVuLCBzbGlkZUJldHdlZW5BbmltYXRpb24sIHByZXZpZXdXaWR0aCwgcHJldmlld0hlaWdodCB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIGNvbnN0IHByZXZpZXdXcmFwcGVyU3R5bGVzID0gW1xuICAgICAgZmxleCxcbiAgICAgIGdldFByZXZpZXdQb3NpdGlvbih0aGlzLmFuaW1hdGVkVmFsdWUsIHByZXZpZXdXaWR0aCwgcHJldmlld0hlaWdodCwgc2xpZGVCZXR3ZWVuQW5pbWF0aW9uKSxcbiAgICBdO1xuXG4gICAgY29uc3QgcHJldmlld1N0eWxlcyA9IFtmbGV4LCBnZXRQcmV2aWV3U2NhbGUodGhpcy5hbmltYXRlZFZhbHVlLCBzbGlkZUJldHdlZW5BbmltYXRpb24pXTtcblxuICAgIHJldHVybiAoXG4gICAgICA8U2FmZUFyZWFWaWV3IHN0eWxlPXtmbGV4fT5cbiAgICAgICAgPEtleWJvYXJkQXZvaWRpbmdWaWV3XG4gICAgICAgICAgZW5hYmxlZD17IXNob3VsZERpc2FibGVLZXlib2FyZEF2b2lkaW5nVmlldyB8fCB0YWJPcGVuICE9PSBQUkVWSUVXfVxuICAgICAgICAgIGJlaGF2aW9yPXtJU19JT1MgPyAncGFkZGluZycgOiBudWxsfVxuICAgICAgICAgIGtleWJvYXJkVmVydGljYWxPZmZzZXQ9e2tleWJvYXJkQXZvaWRpbmdWaWV3VmVydGljYWxPZmZzZXR9XG4gICAgICAgICAgc3R5bGU9e2ZsZXh9XG4gICAgICAgID5cbiAgICAgICAgICA8QWJzb2x1dGVQb3NpdGlvbmVkS2V5Ym9hcmRBd2FyZVZpZXdcbiAgICAgICAgICAgIG9uTGF5b3V0PXt0aGlzLm9uTGF5b3V0fVxuICAgICAgICAgICAgcHJldmlld0hlaWdodD17cHJldmlld0hlaWdodH1cbiAgICAgICAgICAgIHByZXZpZXdXaWR0aD17cHJldmlld1dpZHRofVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxBbmltYXRlZC5WaWV3IHN0eWxlPXtwcmV2aWV3V3JhcHBlclN0eWxlc30+XG4gICAgICAgICAgICAgIDxBbmltYXRlZC5WaWV3IHN0eWxlPXtwcmV2aWV3U3R5bGVzfT5cbiAgICAgICAgICAgICAgICA8UHJldmlldyBkaXNhYmxlZD17dGFiT3BlbiA9PT0gUFJFVklFV30+XG4gICAgICAgICAgICAgICAgICA8U3RvcnlWaWV3IHVybD17dXJsfSBvbkRldmljZSBzdG9yaWVzPXtzdG9yaWVzfSAvPlxuICAgICAgICAgICAgICAgIDwvUHJldmlldz5cbiAgICAgICAgICAgICAgICB7dGFiT3BlbiAhPT0gUFJFVklFVyA/IChcbiAgICAgICAgICAgICAgICAgIDxUb3VjaGFibGVPcGFjaXR5IHN0eWxlPXthYnNvbHV0ZVBvc2l0aW9ufSBvblByZXNzPXt0aGlzLmhhbmRsZU9wZW5QcmV2aWV3fSAvPlxuICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICA8L0FuaW1hdGVkLlZpZXc+XG4gICAgICAgICAgICA8L0FuaW1hdGVkLlZpZXc+XG4gICAgICAgICAgICA8UGFuZWwgc3R5bGU9e2dldE5hdmlnYXRvclBhbmVsUG9zaXRpb24odGhpcy5hbmltYXRlZFZhbHVlLCBwcmV2aWV3V2lkdGgpfT5cbiAgICAgICAgICAgICAgPFN0b3J5TGlzdFZpZXcgc3Rvcmllcz17c3Rvcmllc30gLz5cbiAgICAgICAgICAgIDwvUGFuZWw+XG4gICAgICAgICAgICA8UGFuZWwgc3R5bGU9e2dldEFkZG9uUGFuZWxQb3NpdGlvbih0aGlzLmFuaW1hdGVkVmFsdWUsIHByZXZpZXdXaWR0aCl9PlxuICAgICAgICAgICAgICA8QWRkb25zIC8+XG4gICAgICAgICAgICA8L1BhbmVsPlxuICAgICAgICAgIDwvQWJzb2x1dGVQb3NpdGlvbmVkS2V5Ym9hcmRBd2FyZVZpZXc+XG4gICAgICAgICAgPE5hdmlnYXRpb25cbiAgICAgICAgICAgIHRhYk9wZW49e3RhYk9wZW59XG4gICAgICAgICAgICBvbkNoYW5nZVRhYj17dGhpcy5oYW5kbGVUb2dnbGVUYWJ9XG4gICAgICAgICAgICBpbml0aWFsVWlWaXNpYmxlPXshaXNVSUhpZGRlbn1cbiAgICAgICAgICAvPlxuICAgICAgICA8L0tleWJvYXJkQXZvaWRpbmdWaWV3PlxuICAgICAgPC9TYWZlQXJlYVZpZXc+XG4gICAgKTtcbiAgfVxufVxuIl19 */");var absolutePosition={position:'absolute',top:0,bottom:0,left:0,right:0};var OnDeviceUI=function(_PureComponent){(0,_inherits2["default"])(OnDeviceUI,_PureComponent);function OnDeviceUI(props){var _this;(0,_classCallCheck2["default"])(this,OnDeviceUI);_this=(0,_possibleConstructorReturn2["default"])(this,(0,_getPrototypeOf2["default"])(OnDeviceUI).call(this,props));_this.onLayout=function(_ref2){var previewWidth=_ref2.previewWidth,previewHeight=_ref2.previewHeight;_this.setState({previewWidth:previewWidth,previewHeight:previewHeight});};_this.handleOpenPreview=function(){_this.handleToggleTab(_constants.PREVIEW);};_this.handleToggleTab=function(newTabOpen){var tabOpen=_this.state.tabOpen;if(newTabOpen===tabOpen){return;}_reactNative.Animated.timing(_this.animatedValue,{toValue:newTabOpen,duration:ANIMATION_DURATION,useNativeDriver:true}).start();_this.setState({tabOpen:newTabOpen,slideBetweenAnimation:tabOpen+newTabOpen===_constants.PREVIEW});if(newTabOpen===_constants.PREVIEW){_reactNative.Keyboard.dismiss();}};_this.animatedValue=void 0;_this.channel=void 0;var _tabOpen=props.tabOpen||_constants.PREVIEW;_this.state={tabOpen:_tabOpen,slideBetweenAnimation:false,previewWidth:_reactNative.Dimensions.get('window').width,previewHeight:_reactNative.Dimensions.get('window').height};_this.animatedValue=new _reactNative.Animated.Value(_tabOpen);_this.channel=_addons["default"].getChannel();return _this;}(0,_createClass2["default"])(OnDeviceUI,[{key:"render",value:function render(){var _this$props=this.props,stories=_this$props.stories,url=_this$props.url,isUIHidden=_this$props.isUIHidden,shouldDisableKeyboardAvoidingView=_this$props.shouldDisableKeyboardAvoidingView,keyboardAvoidingViewVerticalOffset=_this$props.keyboardAvoidingViewVerticalOffset;var _this$state=this.state,tabOpen=_this$state.tabOpen,slideBetweenAnimation=_this$state.slideBetweenAnimation,previewWidth=_this$state.previewWidth,previewHeight=_this$state.previewHeight;var previewWrapperStyles=[flex,(0,_animation.getPreviewPosition)(this.animatedValue,previewWidth,previewHeight,slideBetweenAnimation)];var previewStyles=[flex,(0,_animation.getPreviewScale)(this.animatedValue,slideBetweenAnimation)];return _react["default"].createElement(_reactNative.SafeAreaView,{style:flex,__source:{fileName:_jsxFileName,lineNumber:129}},_react["default"].createElement(_reactNative.KeyboardAvoidingView,{enabled:!shouldDisableKeyboardAvoidingView||tabOpen!==_constants.PREVIEW,behavior:IS_IOS?'padding':null,keyboardVerticalOffset:keyboardAvoidingViewVerticalOffset,style:flex,__source:{fileName:_jsxFileName,lineNumber:130}},_react["default"].createElement(_absolutePositionedKeyboardAwareView["default"],{onLayout:this.onLayout,previewHeight:previewHeight,previewWidth:previewWidth,__source:{fileName:_jsxFileName,lineNumber:136}},_react["default"].createElement(_reactNative.Animated.View,{style:previewWrapperStyles,__source:{fileName:_jsxFileName,lineNumber:141}},_react["default"].createElement(_reactNative.Animated.View,{style:previewStyles,__source:{fileName:_jsxFileName,lineNumber:142}},_react["default"].createElement(Preview,{disabled:tabOpen===_constants.PREVIEW,__source:{fileName:_jsxFileName,lineNumber:143}},_react["default"].createElement(_StoryView["default"],{url:url,onDevice:true,stories:stories,__source:{fileName:_jsxFileName,lineNumber:144}})),tabOpen!==_constants.PREVIEW?_react["default"].createElement(_reactNative.TouchableOpacity,{style:absolutePosition,onPress:this.handleOpenPreview,__source:{fileName:_jsxFileName,lineNumber:147}}):null)),_react["default"].createElement(_panel["default"],{style:(0,_animation.getNavigatorPanelPosition)(this.animatedValue,previewWidth),__source:{fileName:_jsxFileName,lineNumber:151}},_react["default"].createElement(_StoryListView["default"],{stories:stories,__source:{fileName:_jsxFileName,lineNumber:152}})),_react["default"].createElement(_panel["default"],{style:(0,_animation.getAddonPanelPosition)(this.animatedValue,previewWidth),__source:{fileName:_jsxFileName,lineNumber:154}},_react["default"].createElement(_addons2["default"],{__source:{fileName:_jsxFileName,lineNumber:155}}))),_react["default"].createElement(_navigation["default"],{tabOpen:tabOpen,onChangeTab:this.handleToggleTab,initialUiVisible:!isUIHidden,__source:{fileName:_jsxFileName,lineNumber:158}})));}}]);return OnDeviceUI;}(_react.PureComponent);exports["default"]=OnDeviceUI;