var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");require("core-js/modules/es.array.concat");require("core-js/modules/es.array.filter");require("core-js/modules/es.array.includes");require("core-js/modules/es.array.reduce");require("core-js/modules/es.array.some");require("core-js/modules/es.function.name");require("core-js/modules/es.object.values");require("core-js/modules/es.string.includes");require("core-js/modules/es.string.trim");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _native=_interopRequireDefault(require("@emotion/native"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _coreEvents=_interopRequireDefault(require("@storybook/core-events"));var _addons=_interopRequireDefault(require("@storybook/addons"));var _text=require("../Shared/text");var _jsxFileName="/Users/shilman/projects/baseline/storybook/app/react-native/src/preview/components/StoryListView/index.tsx";function _EMOTION_STRINGIFIED_CSS_ERROR__(){return"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).";}var SearchBar=_native["default"].TextInput("border-top-left-radius:5px;border-top-right-radius:5px;border-bottom-left-radius:5px;border-bottom-right-radius:5px;font-size:16px;margin-horizontal:5px;margin-vertical:5px;padding-horizontal:5px;padding-vertical:5px;",function(_ref){var theme=_ref.theme;return{backgroundColor:theme.borderColor,color:theme.buttonActiveTextColor};},process.env.NODE_ENV==="production"?"":"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9wcmV2aWV3L2NvbXBvbmVudHMvU3RvcnlMaXN0Vmlldy9pbmRleC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBT2tCIiwiZmlsZSI6Ii4uLy4uLy4uLy4uL3NyYy9wcmV2aWV3L2NvbXBvbmVudHMvU3RvcnlMaXN0Vmlldy9pbmRleC50c3giLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50LCBGdW5jdGlvbkNvbXBvbmVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFNhZmVBcmVhVmlldyB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ0BlbW90aW9uL25hdGl2ZSc7XG5pbXBvcnQgRXZlbnRzIGZyb20gJ0BzdG9yeWJvb2svY29yZS1ldmVudHMnO1xuaW1wb3J0IGFkZG9ucyBmcm9tICdAc3Rvcnlib29rL2FkZG9ucyc7XG5pbXBvcnQgeyBIZWFkZXIsIE5hbWUgfSBmcm9tICcuLi9TaGFyZWQvdGV4dCc7XG5cbmNvbnN0IFNlYXJjaEJhciA9IHN0eWxlZC5UZXh0SW5wdXQoXG4gIHtcbiAgICBib3JkZXJUb3BMZWZ0UmFkaXVzOiA1LFxuICAgIGJvcmRlclRvcFJpZ2h0UmFkaXVzOiA1LFxuICAgIGJvcmRlckJvdHRvbUxlZnRSYWRpdXM6IDUsXG4gICAgYm9yZGVyQm90dG9tUmlnaHRSYWRpdXM6IDUsXG4gICAgZm9udFNpemU6IDE2LFxuICAgIG1hcmdpbkhvcml6b250YWw6IDUsXG4gICAgbWFyZ2luVmVydGljYWw6IDUsXG4gICAgcGFkZGluZ0hvcml6b250YWw6IDUsXG4gICAgcGFkZGluZ1ZlcnRpY2FsOiA1LFxuICB9LFxuICAoeyB0aGVtZSB9KSA9PiAoe1xuICAgIGJhY2tncm91bmRDb2xvcjogdGhlbWUuYm9yZGVyQ29sb3IsXG4gICAgY29sb3I6IHRoZW1lLmJ1dHRvbkFjdGl2ZVRleHRDb2xvcixcbiAgfSlcbik7XG5cbmNvbnN0IEhlYWRlckNvbnRhaW5lciA9IHN0eWxlZC5WaWV3KHtcbiAgcGFkZGluZ1ZlcnRpY2FsOiA1LFxufSk7XG5cbmludGVyZmFjZSBTZWN0aW9uUHJvcHMge1xuICB0aXRsZTogc3RyaW5nO1xuICBzZWxlY3RlZDogYm9vbGVhbjtcbn1cblxuY29uc3QgU2VjdGlvbkhlYWRlcjogRnVuY3Rpb25Db21wb25lbnQ8U2VjdGlvblByb3BzPiA9ICh7IHRpdGxlLCBzZWxlY3RlZCB9OiBTZWN0aW9uUHJvcHMpID0+IChcbiAgPEhlYWRlckNvbnRhaW5lciBrZXk9e3RpdGxlfT5cbiAgICA8SGVhZGVyIHNlbGVjdGVkPXtzZWxlY3RlZH0+e3RpdGxlfTwvSGVhZGVyPlxuICA8L0hlYWRlckNvbnRhaW5lcj5cbik7XG5cbmludGVyZmFjZSBMaXN0SXRlbVByb3BzIHtcbiAgdGl0bGU6IHN0cmluZztcbiAga2luZDogc3RyaW5nO1xuICBzZWxlY3RlZDogYm9vbGVhbjtcbiAgb25QcmVzczogKCkgPT4gdm9pZDtcbn1cblxuY29uc3QgSXRlbVRvdWNoYWJsZSA9IHN0eWxlZC5Ub3VjaGFibGVPcGFjaXR5KHtcbiAgcGFkZGluZ0hvcml6b250YWw6IDE2LFxuICBwYWRkaW5nVmVydGljYWw6IDUsXG59KTtcblxuY29uc3QgTGlzdEl0ZW06IEZ1bmN0aW9uQ29tcG9uZW50PExpc3RJdGVtUHJvcHM+ID0gKHsga2luZCwgdGl0bGUsIHNlbGVjdGVkLCBvblByZXNzIH0pID0+IChcbiAgPEl0ZW1Ub3VjaGFibGVcbiAgICBrZXk9e3RpdGxlfVxuICAgIG9uUHJlc3M9e29uUHJlc3N9XG4gICAgYWN0aXZlT3BhY2l0eT17MC44fVxuICAgIHRlc3RJRD17YFN0b3J5Ym9vay5MaXN0SXRlbS4ke2tpbmR9LiR7dGl0bGV9YH1cbiAgICBhY2Nlc3NpYmlsaXR5TGFiZWw9e2BTdG9yeWJvb2suTGlzdEl0ZW0uJHt0aXRsZX1gfVxuICA+XG4gICAgPE5hbWUgc2VsZWN0ZWQ9e3NlbGVjdGVkfT57dGl0bGV9PC9OYW1lPlxuICA8L0l0ZW1Ub3VjaGFibGU+XG4pO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBzdG9yaWVzOiBhbnk7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIGRhdGE6IGFueVtdO1xuICBvcmlnaW5hbERhdGE6IGFueVtdO1xufVxuXG5jb25zdCBMaXN0ID0gc3R5bGVkLlNlY3Rpb25MaXN0KHtcbiAgZmxleDogMSxcbiAgbWFyZ2luQm90dG9tOiA0MCxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTdG9yeUxpc3RWaWV3IGV4dGVuZHMgQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgZGF0YTogW10sXG4gICAgICBvcmlnaW5hbERhdGE6IFtdLFxuICAgIH07XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICBjb25zdCBjaGFubmVsID0gYWRkb25zLmdldENoYW5uZWwoKTtcbiAgICBjaGFubmVsLm9uKEV2ZW50cy5TVE9SWV9BRERFRCwgdGhpcy5oYW5kbGVTdG9yeUFkZGVkKTtcbiAgICBjaGFubmVsLm9uKEV2ZW50cy5TRUxFQ1RfU1RPUlksIHRoaXMuZm9yY2VSZVJlbmRlcik7XG4gICAgdGhpcy5oYW5kbGVTdG9yeUFkZGVkKCk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICBjb25zdCBjaGFubmVsID0gYWRkb25zLmdldENoYW5uZWwoKTtcbiAgICBjaGFubmVsLnJlbW92ZUxpc3RlbmVyKEV2ZW50cy5TVE9SWV9BRERFRCwgdGhpcy5oYW5kbGVTdG9yeUFkZGVkKTtcbiAgICBjaGFubmVsLnJlbW92ZUxpc3RlbmVyKEV2ZW50cy5TRUxFQ1RfU1RPUlksIHRoaXMuZm9yY2VSZVJlbmRlcik7XG4gIH1cblxuICBmb3JjZVJlUmVuZGVyID0gKCkgPT4ge1xuICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcbiAgfTtcblxuICBoYW5kbGVTdG9yeUFkZGVkID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgc3RvcmllcyB9ID0gdGhpcy5wcm9wcztcblxuICAgIGlmIChzdG9yaWVzKSB7XG4gICAgICBjb25zdCBkYXRhID0gT2JqZWN0LnZhbHVlcyhcbiAgICAgICAgc3Rvcmllc1xuICAgICAgICAgIC5yYXcoKVxuICAgICAgICAgIC5yZWR1Y2UoKGFjYzogeyBba2luZDogc3RyaW5nXTogeyB0aXRsZTogc3RyaW5nOyBkYXRhOiBhbnlbXSB9IH0sIHN0b3J5OiBhbnkpID0+IHtcbiAgICAgICAgICAgIGFjY1tzdG9yeS5raW5kXSA9IHtcbiAgICAgICAgICAgICAgdGl0bGU6IHN0b3J5LmtpbmQsXG4gICAgICAgICAgICAgIGRhdGE6IChhY2Nbc3Rvcnkua2luZF0gPyBhY2Nbc3Rvcnkua2luZF0uZGF0YSA6IFtdKS5jb25jYXQoc3RvcnkpLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICB9LCB7fSlcbiAgICAgICk7XG5cbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBkYXRhLCBvcmlnaW5hbERhdGE6IGRhdGEgfSk7XG4gICAgfVxuICB9O1xuXG4gIGhhbmRsZUNoYW5nZVNlYXJjaFRleHQgPSAodGV4dDogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgcXVlcnkgPSB0ZXh0LnRyaW0oKTtcbiAgICBjb25zdCB7IG9yaWdpbmFsRGF0YTogZGF0YSB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIGlmICghcXVlcnkpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBkYXRhIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGNoZWNrVmFsdWUgPSAodmFsdWU6IHN0cmluZykgPT4gdmFsdWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKTtcbiAgICBjb25zdCBmaWx0ZXJlZERhdGEgPSBkYXRhLnJlZHVjZSgoYWNjLCBzdG9yeSkgPT4ge1xuICAgICAgY29uc3QgaGFzVGl0bGUgPSBjaGVja1ZhbHVlKHN0b3J5LnRpdGxlKTtcbiAgICAgIGNvbnN0IGhhc0tpbmQgPSBzdG9yeS5kYXRhLnNvbWUoKHJlZjogYW55KSA9PiBjaGVja1ZhbHVlKHJlZi5uYW1lKSk7XG5cbiAgICAgIGlmIChoYXNUaXRsZSB8fCBoYXNLaW5kKSB7XG4gICAgICAgIGFjYy5wdXNoKHtcbiAgICAgICAgICAuLi5zdG9yeSxcbiAgICAgICAgICAvLyBpbiBjYXNlIHRoZSBxdWVyeSBtYXRjaGVzIGNvbXBvbmVudCdzIHRpdGxlLCBhbGwgb2YgaXRzIHN0b3JpZXMgd2lsbCBiZSBzaG93blxuICAgICAgICAgIGRhdGE6ICFoYXNUaXRsZSA/IHN0b3J5LmRhdGEuZmlsdGVyKChyZWY6IGFueSkgPT4gY2hlY2tWYWx1ZShyZWYubmFtZSkpIDogc3RvcnkuZGF0YSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwgW10pO1xuXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGRhdGE6IGZpbHRlcmVkRGF0YSB9KTtcbiAgfTtcblxuICBjaGFuZ2VTdG9yeShzdG9yeUlkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBjaGFubmVsID0gYWRkb25zLmdldENoYW5uZWwoKTtcbiAgICBjaGFubmVsLmVtaXQoRXZlbnRzLlNFVF9DVVJSRU5UX1NUT1JZLCB7IHN0b3J5SWQgfSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBzdG9yaWVzIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgc3RvcnlJZCB9ID0gc3Rvcmllcy5nZXRTZWxlY3Rpb24oKTtcbiAgICBjb25zdCBzZWxlY3RlZFN0b3J5ID0gc3Rvcmllcy5mcm9tSWQoc3RvcnlJZCk7XG4gICAgY29uc3QgeyBkYXRhIH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxTYWZlQXJlYVZpZXcgc3R5bGU9e3sgZmxleDogMSB9fT5cbiAgICAgICAgPFNlYXJjaEJhclxuICAgICAgICAgIHRlc3RJRD1cIlN0b3J5Ym9vay5MaXN0Vmlldy5TZWFyY2hCYXJcIlxuICAgICAgICAgIGNsZWFyQnV0dG9uTW9kZT1cIndoaWxlLWVkaXRpbmdcIlxuICAgICAgICAgIGRpc2FibGVGdWxsc2NyZWVuVUlcbiAgICAgICAgICBvbkNoYW5nZVRleHQ9e3RoaXMuaGFuZGxlQ2hhbmdlU2VhcmNoVGV4dH1cbiAgICAgICAgICBwbGFjZWhvbGRlcj1cIkZpbHRlclwiXG4gICAgICAgICAgcmV0dXJuS2V5VHlwZT1cInNlYXJjaFwiXG4gICAgICAgIC8+XG4gICAgICAgIDxMaXN0XG4gICAgICAgICAgdGVzdElEPVwiU3Rvcnlib29rLkxpc3RWaWV3XCJcbiAgICAgICAgICByZW5kZXJJdGVtPXsoeyBpdGVtIH0pID0+IChcbiAgICAgICAgICAgIDxMaXN0SXRlbVxuICAgICAgICAgICAgICB0aXRsZT17aXRlbS5uYW1lfVxuICAgICAgICAgICAgICBraW5kPXtpdGVtLmtpbmR9XG4gICAgICAgICAgICAgIHNlbGVjdGVkPXtzZWxlY3RlZFN0b3J5ICYmIGl0ZW0uaWQgPT09IHNlbGVjdGVkU3RvcnkuaWR9XG4gICAgICAgICAgICAgIG9uUHJlc3M9eygpID0+IHRoaXMuY2hhbmdlU3RvcnkoaXRlbS5pZCl9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICl9XG4gICAgICAgICAgcmVuZGVyU2VjdGlvbkhlYWRlcj17KHsgc2VjdGlvbjogeyB0aXRsZSB9IH0pID0+IChcbiAgICAgICAgICAgIDxTZWN0aW9uSGVhZGVyIHRpdGxlPXt0aXRsZX0gc2VsZWN0ZWQ9e3NlbGVjdGVkU3RvcnkgJiYgdGl0bGUgPT09IHNlbGVjdGVkU3Rvcnkua2luZH0gLz5cbiAgICAgICAgICApfVxuICAgICAgICAgIGtleUV4dHJhY3Rvcj17KGl0ZW0sIGluZGV4KSA9PiBpdGVtICsgaW5kZXh9XG4gICAgICAgICAgc2VjdGlvbnM9e2RhdGF9XG4gICAgICAgICAgc3RpY2t5U2VjdGlvbkhlYWRlcnNFbmFibGVkPXtmYWxzZX1cbiAgICAgICAgLz5cbiAgICAgIDwvU2FmZUFyZWFWaWV3PlxuICAgICk7XG4gIH1cbn1cbiJdfQ== */");var HeaderContainer=_native["default"].View("padding-vertical:5px;");var SectionHeader=function SectionHeader(_ref2){var title=_ref2.title,selected=_ref2.selected;return _react["default"].createElement(HeaderContainer,{key:title,__source:{fileName:_jsxFileName,lineNumber:36}},_react["default"].createElement(_text.Header,{selected:selected,__source:{fileName:_jsxFileName,lineNumber:37}},title));};var ItemTouchable=_native["default"].TouchableOpacity("padding-horizontal:16px;padding-vertical:5px;");var ListItem=function ListItem(_ref3){var kind=_ref3.kind,title=_ref3.title,selected=_ref3.selected,onPress=_ref3.onPress;return _react["default"].createElement(ItemTouchable,{key:title,onPress:onPress,activeOpacity:0.8,testID:"Storybook.ListItem."+kind+"."+title,accessibilityLabel:"Storybook.ListItem."+title,__source:{fileName:_jsxFileName,lineNumber:54}},_react["default"].createElement(_text.Name,{selected:selected,__source:{fileName:_jsxFileName,lineNumber:61}},title));};var List=_native["default"].SectionList("flex:1;margin-bottom:40px;");var StoryListView=function(_Component){(0,_inherits2["default"])(StoryListView,_Component);function StoryListView(props){var _this;(0,_classCallCheck2["default"])(this,StoryListView);_this=(0,_possibleConstructorReturn2["default"])(this,(0,_getPrototypeOf2["default"])(StoryListView).call(this,props));_this.forceReRender=function(){_this.forceUpdate();};_this.handleStoryAdded=function(){var stories=_this.props.stories;if(stories){var data=Object.values(stories.raw().reduce(function(acc,story){acc[story.kind]={title:story.kind,data:(acc[story.kind]?acc[story.kind].data:[]).concat(story)};return acc;},{}));_this.setState({data:data,originalData:data});}};_this.handleChangeSearchText=function(text){var query=text.trim();var data=_this.state.originalData;if(!query){_this.setState({data:data});return;}var checkValue=function checkValue(value){return value.toLowerCase().includes(query.toLowerCase());};var filteredData=data.reduce(function(acc,story){var hasTitle=checkValue(story.title);var hasKind=story.data.some(function(ref){return checkValue(ref.name);});if(hasTitle||hasKind){acc.push((0,_extends2["default"])({},story,{data:!hasTitle?story.data.filter(function(ref){return checkValue(ref.name);}):story.data}));}return acc;},[]);_this.setState({data:filteredData});};_this.state={data:[],originalData:[]};return _this;}(0,_createClass2["default"])(StoryListView,[{key:"componentDidMount",value:function componentDidMount(){var channel=_addons["default"].getChannel();channel.on(_coreEvents["default"].STORY_ADDED,this.handleStoryAdded);channel.on(_coreEvents["default"].SELECT_STORY,this.forceReRender);this.handleStoryAdded();}},{key:"componentWillUnmount",value:function componentWillUnmount(){var channel=_addons["default"].getChannel();channel.removeListener(_coreEvents["default"].STORY_ADDED,this.handleStoryAdded);channel.removeListener(_coreEvents["default"].SELECT_STORY,this.forceReRender);}},{key:"changeStory",value:function changeStory(storyId){var channel=_addons["default"].getChannel();channel.emit(_coreEvents["default"].SET_CURRENT_STORY,{storyId:storyId});}},{key:"render",value:function render(){var _this2=this;var stories=this.props.stories;var _stories$getSelection=stories.getSelection(),storyId=_stories$getSelection.storyId;var selectedStory=stories.fromId(storyId);var data=this.state.data;return _react["default"].createElement(_reactNative.SafeAreaView,{style:{flex:1},__source:{fileName:_jsxFileName,lineNumber:167}},_react["default"].createElement(SearchBar,{testID:"Storybook.ListView.SearchBar",clearButtonMode:"while-editing",disableFullscreenUI:true,onChangeText:this.handleChangeSearchText,placeholder:"Filter",returnKeyType:"search",__source:{fileName:_jsxFileName,lineNumber:168}}),_react["default"].createElement(List,{testID:"Storybook.ListView",renderItem:function renderItem(_ref4){var item=_ref4.item;return _react["default"].createElement(ListItem,{title:item.name,kind:item.kind,selected:selectedStory&&item.id===selectedStory.id,onPress:function onPress(){return _this2.changeStory(item.id);},__source:{fileName:_jsxFileName,lineNumber:179}});},renderSectionHeader:function renderSectionHeader(_ref5){var title=_ref5.section.title;return _react["default"].createElement(SectionHeader,{title:title,selected:selectedStory&&title===selectedStory.kind,__source:{fileName:_jsxFileName,lineNumber:187}});},keyExtractor:function keyExtractor(item,index){return item+index;},sections:data,stickySectionHeadersEnabled:false,__source:{fileName:_jsxFileName,lineNumber:176}}));}}]);return StoryListView;}(_react.Component);exports["default"]=StoryListView;